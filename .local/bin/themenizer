#!/usr/bin/env bash

# Required dependencies
required=("wal" "swaybg" "colorz")

# Check dependencies
for cmd in "${required[@]}"; do
  if ! which "$cmd" &> /dev/null; then
    echo "Error: '$cmd' not found"
    exit 1
  fi
done

WALLPAPER_DIR=~/wallpapers/

WALLPAPER=$(find "$WALLPAPER_DIR" -type f | shuf -n 1)

wal --backend modern_colorthief -qnti $WALLPAPER &

pkill swaybg 

swaybg -i $WALLPAPER 

# Theme reloads
ln -sf ~/.cache/wal/colors-waybar.css ~/.config/waybar/wal-theme.css
# ln -sf ~/.cache/wal/ghostty.conf ~/.config/ghostty/themes/wal-theme
# pkill -SIGUSR2 ghostty
